---
title: "Chapter 6 Performing Vulnerability Assessments"
date: 2024-03-14T10:07:50Z
draft: false
categories: ["Computing"]
tags: ["Lain", ""]
series: ["Ultimate Kali Linux Book"]
series_order: 6
---



## 1. Going through the Nessus Essentials setup
- https://www.tenable.com/downloads/nessus?loginAttempted=true
- Download the deb file for kali and install it on system
- Run [[Systemctl]] service and open web portal with `sudo systemctl start nessusd`
	- This uses a lot of resources on the cpu
	- ?! Is there a way to check how much resources systemctl processes uses ?
![[Pasted image 20240304191348.png]]
- A scan will provide vulnerabilities along with it Common vulnerability Score System (CVSS) out of 10 to show danger levels which can be determined by this calculator https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:N/SI:N/SA:N
## 2. Making use of the Nmap Scripting Engine NSE

Documentation located here https://nmap.org/book/man-nse.html


- This is an engine which can run scripts such as custom types of scans, discovery and even exploit execution on targets which is quite powerful.
	- It uses the Lua programming language
- The currently defined categories are `auth`, `broadcast`, `brute`, `default`. `discovery`, `dos`, `exploit`, `external`, `fuzzer`, `intrusive`, `malware`, `safe`, `version`, and `vuln`
- Search script in these categories with `nmap --script "<keyword>"`
- Script can be found here https://nmap.org/nsedoc/scripts/

- running `nmap --script ftp-vsftpd-backdoor 172.30.1.20` will show if the ftp port version used is vulnerable to a 2011 exploit
- To see if there are any exploits available in the metasploitable framework `searchsploit vsFTPd`, this will provide a description of any found exploits
- To do an entire category scan use `nmap --script vuln 172.30.1.20`
This is a great starting point for showing the capabilities of nmap and how truly versatile it can be, though it was only a networking port scanning tools but it can do a lot more

# 3. Greenbone security scanner
This tool seems to be similar to nessus tool which provides lots of options for reconnaissance.
```bash
sudo apt install gvm
sudo gvm-setup
sudo gvm-start
sudo runuser -u _gvm -- gvmd --user=admin --new-password=new_password  # reset pass
```

# 4. Using Web Application Scanners
The methods above where overall system vulnerability scanners which will include results for all sorts of vulnerabilities so this section is all scanner methods for web technologies
## WhatWeb
This is a finger printing tool specifically for websites to identify technologies used and extra information such as emails
- Use `whatweb <IP>`
- Example outcome:
![[Pasted image 20240314134511.png]]
- Provides web applications and versions
- Web technologies and versions
- Host operating systems and emails
## Nmap Web Application Scanning
Scripts for nmap can be found in `/usr/share/nmap/scripts/http*` where I can use [[Pattern Searches]] to find specific files
- This will display a list of scripts for http technologies, here is where I can find the sql injection script
	- Use with `nmap --script http-sql-injection <IP>`
- I should look into https://nmap.org/nsedoc/ and explore different possible script to execute on specific technologies
## Using Metasploit's Wmap for web scanning
- First initialise metasploit database `service postgresql start`
- `sudo msfdb init && msfconsole`
```bash
Metasploitable framework
Ctrl + X               # Clear terminal
load -l                # Display all modules
load wmap              # Load into wmap
help                   # Update the help menu with new commands at top
wmap_sites -a 172.30.1.23  # Main site of where the attack will happen
wmap_targets -t 172.30.1.23/mutilliadae/ # Specific directory for attack
wmap_targets -l        # List targets from sites
wmap_run -t            # List all loaded modules for scans
wmap_run -e            # Run all scans on target
```
## Nikto
# Related Questions
?! What are the best resources to find vulnerability management ?

# Related Ideas
<% tp.file.cursor(5) %>

